"0","#| label: task2.15-testing"
"0","#| message: false"
"0","#| warning: true"
"0","#| error: true"
"0","#| echo: true"
"0","#| eval: true"
"0","#| include: true"
"0","library(readxl)"
"0","library(dplyr)"
"0","library(tidyr)"
"0","library(stringr)"
"0",""
"0","# --- Import Data ---"
"0","year_header <- read_excel("
"0","  ""data/task2/outputFile.xlsx"","
"0","  sheet     = ""T4"","
"0","  range     = ""A11:BQ11"","
"0","  col_names = FALSE"
"0",")"
"0","sg_raw <- read_excel("
"0","  ""data/task2/outputFile.xlsx"","
"0","  sheet     = ""T4"","
"0","  range     = ""A37:BQ86"","
"0","  col_names = FALSE"
"0",")"
"0",""
"0","# --- Data Parsing ---"
"0","# Drop ""Data Series"" in header"
"0","years <- as.character(as.numeric(year_header[1, -1]))"
"0",""
"0","# Find where female block starts"
"0","female_start <- which(sg_raw[[1]] == ""Total Female Residents"")"
"0",""
"0","# Split into male_raw and female_raw"
"0","male_raw   <- sg_raw[1:(female_start - 1), ]"
"0","female_raw <- sg_raw[female_start:nrow(sg_raw), ]"
"0",""
"0","# Assign column names: age_group + years"
"0","colnames(male_raw)   <- c(""age_group"", years)"
"0","colnames(female_raw) <- c(""age_group"", years)"
"0",""
"0","# Preview raw blocks"
"0","head(male_raw, 5)"
